<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama PDFD - Préstamo de Material Bibliográfico</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f4; }
        .flow-container { display: flex; flex-direction: column; align-items: center; max-width: 1200px; margin: 0 auto; }
        .node { background-color: #e0f7fa; border: 2px solid #00bcd4; border-radius: 8px; padding: 10px; margin: 5px; text-align: center; min-width: 200px; }
        .process { background-color: #fff3e0; border-color: #ff9800; }
        .data-store { background-color: #f3e5f5; border-color: #9c27b0; font-style: italic; }
        .entity { background-color: #e8f5e8; border-color: #4caf50; }
        .arrow { font-size: 20px; color: #666; margin: 0 10px; }
        .vertical-flow { display: flex; flex-direction: column; align-items: center; }
        .horizontal-flow { display: flex; align-items: center; justify-content: center; width: 100%; }
        .stage { background-color: #ffebee; border-color: #f44336; font-weight: bold; }
        .additional-flow { margin-top: 40px; border-top: 2px dashed #ccc; padding-top: 20px; }
        svg.arrow-svg { position: absolute; }
    </style>
</head>
<body>
    <div class="flow-container">
        <h1>Diagrama PDFD Físico - Proceso de Préstamo y Devolución en Biblioteca Escolar</h1>
        
        <!-- Flujo Principal de Préstamo -->
        <div class="vertical-flow">
            <div class="horizontal-flow">
                <div class="entity">[ Usuario ]</div>
                <span class="arrow">→</span>
                <div class="process">Solicitud Préstamo (ID Usuario + ISBN, Validación Membresía)</div>
                <span class="arrow">→</span>
                <div class="process">Gestión de Préstamo (Módulo PHP + Escáner Manual por Bibliotecario)</div>
            </div>
            
            <div class="stage">Etapas 2-4: Análisis Conceptual (ERD), Transformación Lógica, Optimización (Normalización 3FN, Índices)</div>
            
            <span class="arrow">↓ Consulta SELECT Disponibilidad (Etapa 4: Indexación)</span>
            
            <div class="horizontal-flow">
                <div class="data-store">D1: Catálogo de Materiales (Tabla Libros en MySQL)</div>
                <span class="arrow">↔</span>
                <div class="process">Actualización UPDATE Disponible=FALSE (Etapa 5: DDL Físico)</div>
            </div>
            
            <span class="arrow">↑ Registro INSERT Préstamo (Etapa 6: Implementación y Carga de Datos)</span>
            
            <div class="horizontal-flow">
                <div class="data-store">D2: Registros de Usuarios (Tabla Préstamos en MySQL, Restricciones FK)</div>
                <span class="arrow">↔</span>
                <div class="process">Confirmación (Etapa 6)</div>
            </div>
            
            <span class="arrow">↓ Confirmación Préstamo (Recibo Digital/Impreso)</span>
            
            <div class="horizontal-flow">
                <div class="entity">[ Bibliotecario ]</div>
                <span class="arrow">↔</span>
                <div class="process">Intervención Manual y Notificación (Etapa 7: Pruebas y Ajustes)</div>
                <span class="arrow">→</span>
                <div class="stage">SALIDA: Documentación y Mantenimiento (Etapa 8) - Reportes Finales</div>
            </div>
        </div>
        
        <!-- Flujo Adicional para Devolución -->
        <div class="additional-flow">
            <h2>Flujo Adicional para Devolución (Procesos Secuenciados)</h2>
            <div class="vertical-flow">
                <div class="horizontal-flow">
                    <div class="entity">[ Usuario ]</div>
                    <span class="arrow">→</span>
                    <div class="process">Solicitud Devolución (ID Préstamo, Control Fecha/Multa >14 días)</div>
                    <span class="arrow">→</span>
                    <div class="process">Gestión de Préstamo</div>
                </div>
                
                <div class="stage">Etapas 2-5: Diseño Conceptual, Lógico/Físico</div>
                
                <span class="arrow">↓ Actualización UPDATE Fecha_Devolución (Etapa 6: Carga)</span>
                
                <div class="horizontal-flow">
                    <div class="data-store">D1 y D2: Actualización Física (Liberación UPDATE Disponible=TRUE)</div>
                    <span class="arrow">↔</span>
                    <div class="process">Etapa 7: Pruebas Integridad</div>
                </div>
                
                <span class="arrow">↓ Notificación Liberación (Reporte Cierre con Multa)</span>
                
                <div class="horizontal-flow">
                    <div class="entity">[ Bibliotecario ]</div>
                    <span class="arrow">↔</span>
                    <div class="process">Archivado y Actualizaciones Periódicas (Etapa 8: Procedimientos Mantenimiento)</div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>